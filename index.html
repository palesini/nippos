<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Asistencia - Construcci√≥n</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>üèóÔ∏è Asistencia</h1>
                <p>Sistema de Control</p>
            </div>
            
            <nav class="sidebar-nav">
                <button class="nav-item active" data-view="registro" onclick="changeView('registro')">
                    <span class="icon">üìù</span>
                    <span>Registrar Asistencia</span>
                </button>
                <button class="nav-item" data-view="consultas" onclick="changeView('consultas')">
                    <span class="icon">üîç</span>
                    <span>Consultar</span>
                </button>
                <button class="nav-item" data-view="empleados" onclick="changeView('empleados')">
                    <span class="icon">üë∑</span>
                    <span>Empleados</span>
                </button>
                <button class="nav-item" data-view="clientes" onclick="changeView('clientes')">
                    <span class="icon">üè¢</span>
                    <span>Clientes</span>
                </button>
                <button class="nav-item" data-view="obras" onclick="changeView('obras')">
                    <span class="icon">üèóÔ∏è</span>
                    <span>Obras</span>
                </button>
                <button class="nav-item" data-view="lideres" onclick="changeView('lideres')">
                    <span class="icon">üëî</span>
                    <span>L√≠deres</span>
                </button>
                <button class="nav-item" data-view="reportes" onclick="changeView('reportes')">
                    <span class="icon">üìä</span>
                    <span>Reportes</span>
                </button>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Vista: Registrar Asistencia -->
            <div id="view-registro" class="view active">
                <div class="view-header">
                    <h2>Registrar Asistencia Diaria</h2>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Informaci√≥n del Registro</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="registroFecha">Fecha</label>
                                <input type="date" id="registroFecha" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="registroObra">Obra</label>
                                <select id="registroObra" class="form-control" required onchange="cargarInfoObra()">
                                    <option value="">Seleccione una obra...</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="obraInfoContainer" style="display: none; padding: 15px; background: #f8f9fa; border-radius: 8px; margin-top: 15px;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div>
                                    <strong>Cliente:</strong>
                                    <div id="infoObraCliente" style="color: #666;">-</div>
                                </div>
                                <div>
                                    <strong>Encargado/L√≠der:</strong>
                                    <div id="infoObraLider" style="color: #666;">-</div>
                                </div>
                                <div>
                                    <strong>Direcci√≥n:</strong>
                                    <div id="infoObraDireccion" style="color: #666;">-</div>
                                </div>
                            </div>
                        </div>

                        <div class="shift-selector">
                            <label>Tipo de Jornada</label>
                            <div class="shift-buttons">
                                <button class="shift-btn active" data-shift="dia" onclick="selectShift('dia')">
                                    ‚òÄÔ∏è D√≠a
                                </button>
                                <button class="shift-btn" data-shift="noche" onclick="selectShift('noche')">
                                    üåô Noche
                                </button>
                                <button class="shift-btn" data-shift="dia_noche" onclick="selectShift('dia_noche')">
                                    üåì D√≠a y Noche
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Lista de Trabajadores</h3>
                        <button class="btn btn-secondary" onclick="cargarAsistenciaExistente()">
                            üîÑ Cargar registro existente
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="listaEmpleadosRegistro" class="workers-list">
                            <!-- Se llenar√° din√°micamente -->
                        </div>
                    </div>
                </div>

                <div class="action-bar">
                    <div class="stats-summary">
                        <div class="stat-item">
                            <span class="stat-label">Presentes:</span>
                            <span class="stat-value" id="statPresentes">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Ausentes:</span>
                            <span class="stat-value" id="statAusentes">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total:</span>
                            <span class="stat-value" id="statTotal">0</span>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-lg" onclick="guardarAsistencias()">
                        üíæ Guardar Asistencias
                    </button>
                </div>
            </div>

            <!-- Vista: Consultas -->
            <div id="view-consultas" class="view">
                <div class="view-header">
                    <h2>Consultar Asistencias</h2>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Filtros de B√∫squeda</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="consultaFechaDesde">Desde</label>
                                <input type="date" id="consultaFechaDesde" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="consultaFechaHasta">Hasta</label>
                                <input type="date" id="consultaFechaHasta" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="consultaCliente">Cliente</label>
                                <select id="consultaCliente" class="form-control">
                                    <option value="">Todos los clientes</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="consultaObra">Obra</label>
                                <select id="consultaObra" class="form-control">
                                    <option value="">Todas las obras</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="consultaEmpleado">Empleado</label>
                                <select id="consultaEmpleado" class="form-control">
                                    <option value="">Todos los empleados</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="consultaLider">L√≠der</label>
                                <select id="consultaLider" class="form-control">
                                    <option value="">Todos los l√≠deres</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="buscarAsistencias()">
                            üîç Buscar
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Resultados</h3>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="data-table" id="tablaConsultas">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Cliente</th>
                                        <th>Obra</th>
                                        <th>Empleado</th>
                                        <th>Cargo</th>
                                        <th>L√≠der</th>
                                        <th>Asistencia</th>
                                        <th>Jornada</th>
                                        <th>H. Extras</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se llenar√° din√°micamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vista: Empleados -->
            <div id="view-empleados" class="view">
                <div class="view-header">
                    <h2>Gesti√≥n de Empleados</h2>
                    <button class="btn btn-primary" onclick="mostrarModalEmpleado()">
                        + Nuevo Empleado
                    </button>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="data-table" id="tablaEmpleados">
                                <thead>
                                    <tr>
                                        <th>Foto</th>
                                        <th>Nombre</th>
                                        <th>DNI</th>
                                        <th>Cargo</th>
                                        <th>Tel√©fono</th>
                                        <th>Fecha Ingreso</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se llenar√° din√°micamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vista: Clientes -->
            <div id="view-clientes" class="view">
                <div class="view-header">
                    <h2>Gesti√≥n de Clientes</h2>
                    <button class="btn btn-primary" onclick="mostrarModalCliente()">
                        + Nuevo Cliente
                    </button>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="data-table" id="tablaClientes">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Raz√≥n Social</th>
                                        <th>RUC/DNI</th>
                                        <th>Tel√©fono</th>
                                        <th>Email</th>
                                        <th>Obras</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se llenar√° din√°micamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vista: Obras -->
            <div id="view-obras" class="view">
                <div class="view-header">
                    <h2>Gesti√≥n de Obras</h2>
                    <button class="btn btn-primary" onclick="mostrarModalObra()">
                        + Nueva Obra
                    </button>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="data-table" id="tablaObras">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Cliente</th>
                                        <th>L√≠der</th>
                                        <th>Direcci√≥n</th>
                                        <th>Fecha Inicio</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se llenar√° din√°micamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vista: L√≠deres -->
            <div id="view-lideres" class="view">
                <div class="view-header">
                    <h2>Gesti√≥n de L√≠deres/Encargados</h2>
                    <button class="btn btn-primary" onclick="mostrarModalLider()">
                        + Nuevo L√≠der
                    </button>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="data-table" id="tablaLideres">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Tel√©fono</th>
                                        <th>Email</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se llenar√° din√°micamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vista: Reportes -->
            <div id="view-reportes" class="view">
                <div class="view-header">
                    <h2>Reportes y Estad√≠sticas</h2>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Filtros</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="reporteFechaDesde">Desde</label>
                                <input type="date" id="reporteFechaDesde" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="reporteFechaHasta">Hasta</label>
                                <input type="date" id="reporteFechaHasta" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="reporteObra">Obra</label>
                                <select id="reporteObra" class="form-control">
                                    <option value="">Todas las obras</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="generarReporte()">
                            üìä Generar Reporte
                        </button>
                    </div>
                </div>

                <div id="reporteResultados" class="report-grid">
                    <!-- Se llenar√° din√°micamente -->
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para Empleado -->
    <div id="modalEmpleado" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalEmpleadoTitulo">Agregar Empleado</h3>
                <button class="modal-close" onclick="cerrarModalEmpleado()">√ó</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="empleadoId">
                
                <div class="form-group">
                    <label>Foto del Empleado</label>
                    <div class="photo-upload-container">
                        <div class="photo-preview" id="photoPreview">
                            <img id="photoPreviewImg" src="" alt="Vista previa" style="display: none;">
                            <div id="photoPlaceholder" class="photo-placeholder">
                                <span>üì∑</span>
                                <p>Seleccionar foto</p>
                            </div>
                        </div>
                        <input type="file" id="empleadoFoto" accept="image/*" onchange="previsualizarFoto(this)">
                        <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('empleadoFoto').click()">
                            üìÅ Seleccionar Foto
                        </button>
                        <button type="button" class="btn btn-danger btn-sm" onclick="eliminarFoto()" id="btnEliminarFoto" style="display: none;">
                            üóëÔ∏è Eliminar
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Nombre *</label>
                    <input type="text" id="empleadoNombre" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Apellido *</label>
                    <input type="text" id="empleadoApellido" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>DNI</label>
                    <input type="text" id="empleadoDNI" class="form-control">
                </div>
                <div class="form-group">
                    <label>Cargo</label>
                    <input type="text" id="empleadoCargo" class="form-control" placeholder="Ej: Obrero, Maestro, Electricista">
                </div>
                <div class="form-group">
                    <label>Tel√©fono</label>
                    <input type="tel" id="empleadoTelefono" class="form-control" placeholder="Ej: +54 9 11 1234-5678">
                </div>
                <div class="form-group">
                    <label>Fecha de Ingreso</label>
                    <input type="date" id="empleadoFechaIngreso" class="form-control">
                </div>
                <div class="form-group">
                    <label>Estado</label>
                    <select id="empleadoEstado" class="form-control">
                        <option value="activo">Activo</option>
                        <option value="inactivo">Inactivo</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="cerrarModalEmpleado()">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarEmpleado()">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Obra -->
    <div id="modalObra" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 id="modalObraTitulo">Agregar Obra</h3>
                <button class="modal-close" onclick="cerrarModalObra()">√ó</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="obraId">
                
                <div class="form-group">
                    <label>Nombre de la Obra *</label>
                    <input type="text" id="obraNombre" class="form-control" required>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Cliente *</label>
                        <select id="obraCliente" class="form-control" required>
                            <option value="">Seleccione un cliente...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Encargado/L√≠der *</label>
                        <select id="obraLider" class="form-control" required>
                            <option value="">Seleccione un l√≠der...</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Direcci√≥n</label>
                    <input type="text" id="obraDireccion" class="form-control">
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Fecha de Inicio</label>
                        <input type="date" id="obraFechaInicio" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Fecha de Fin (estimada)</label>
                        <input type="date" id="obraFechaFin" class="form-control">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Estado</label>
                    <select id="obraEstado" class="form-control">
                        <option value="activa">Activa</option>
                        <option value="pausada">Pausada</option>
                        <option value="finalizada">Finalizada</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Empleados Asignados</label>
                    <div style="max-height: 200px; overflow-y: auto; border: 2px solid #e0e0e0; border-radius: 8px; padding: 10px;">
                        <div id="listaEmpleadosObra">
                            <!-- Se llenar√° din√°micamente -->
                        </div>
                    </div>
                    <small style="color: #666; margin-top: 5px; display: block;">
                        Selecciona los empleados que trabajar√°n en esta obra
                    </small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="cerrarModalObra()">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarObra()">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Modal para L√≠der -->
    <div id="modalLider" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalLiderTitulo">Agregar L√≠der/Encargado</h3>
                <button class="modal-close" onclick="cerrarModalLider()">√ó</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="liderId">
                <div class="form-group">
                    <label>Nombre *</label>
                    <input type="text" id="liderNombre" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Apellido *</label>
                    <input type="text" id="liderApellido" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Tel√©fono</label>
                    <input type="tel" id="liderTelefono" class="form-control" placeholder="Ej: +54 9 11 1234-5678">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="liderEmail" class="form-control">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="cerrarModalLider()">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarLider()">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Cliente -->
    <div id="modalCliente" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalClienteTitulo">Agregar Cliente</h3>
                <button class="modal-close" onclick="cerrarModalCliente()">√ó</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="clienteId">
                <div class="form-group">
                    <label>Nombre *</label>
                    <input type="text" id="clienteNombre" class="form-control" required placeholder="Nombre del cliente">
                </div>
                <div class="form-group">
                    <label>Raz√≥n Social</label>
                    <input type="text" id="clienteRazonSocial" class="form-control" placeholder="Raz√≥n social completa">
                </div>
                <div class="form-group">
                    <label>RUC / DNI</label>
                    <input type="text" id="clienteRucDni" class="form-control" placeholder="N√∫mero de identificaci√≥n">
                </div>
                <div class="form-group">
                    <label>Tel√©fono</label>
                    <input type="tel" id="clienteTelefono" class="form-control" placeholder="Ej: +54 9 11 1234-5678">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="clienteEmail" class="form-control" placeholder="correo@ejemplo.com">
                </div>
                <div class="form-group">
                    <label>Direcci√≥n</label>
                    <input type="text" id="clienteDireccion" class="form-control" placeholder="Direcci√≥n completa">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="cerrarModalCliente()">Cancelar</button>
                <button class="btn btn-primary" onclick="guardarCliente()">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Notificaci√≥n -->
    <div id="notification" class="notification"></div>

    <script src="script.js"></script>
</body>
</html>
